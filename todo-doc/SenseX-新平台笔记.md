### 用mipsel 编译器出错


[ 98%] Building CXX object SampleApp/src/CMakeFiles/SampleApp.dir/SampleApplication.cpp.o
/usr/bin/cmake: /usr/local/lib/libcurl.so.4: no version information available (required by /usr/bin/cmake)
[100%] Building CXX object SampleApp/src/CMakeFiles/SampleApp.dir/main.cpp.o
/usr/bin/cmake: /usr/local/lib/libcurl.so.4: no version information available (required by /usr/bin/cmake)
[100%] Linking CXX executable SampleApp
/usr/bin/cmake: /usr/local/lib/libcurl.so.4: no version information available (required by /usr/bin/cmake)
CMakeFiles/SampleApp.dir/SampleApplication.cpp.o: In function `alexaClientSDK::avsCommon::utils::sds::SharedDataStream<alexaClientSDK::avsCommon::utils::sds::InProcessSDSTraits>::BufferLayout::init(unsigned int, unsigned int)':
SampleApplication.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj]+0x2a4): undefined reference to `__atomic_store_8'
SampleApplication.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj]+0x2b8): undefined reference to `__atomic_store_8'
SampleApplication.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj]+0x2cc): undefined reference to `__atomic_store_8'
SampleApplication.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj]+0x310): undefined reference to `__atomic_store_8'
SampleApplication.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12BufferLayout4initEjj]+0x32c): undefined reference to `__atomic_store_8'
CMakeFiles/SampleApp.dir/PortAudioMicrophoneWrapper.cpp.o: In function `alexaClientSDK::avsCommon::utils::sds::SharedDataStream<alexaClientSDK::avsCommon::utils::sds::InProcessSDSTraits>::createWriter(alexaClientSDK::avsCommon::utils::sds::WriterPolicy, bool)':
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb]+0x208): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb]+0x220): undefined reference to `__atomic_store_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb]+0x2e4): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb]+0x2fc): undefined reference to `__atomic_store_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb]+0x364): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE12createWriterENS2_12WriterPolicyEb]+0x37c): undefined reference to `__atomic_store_8'
CMakeFiles/SampleApp.dir/PortAudioMicrophoneWrapper.cpp.o: In function `alexaClientSDK::avsCommon::utils::sds::SharedDataStream<alexaClientSDK::avsCommon::utils::sds::InProcessSDSTraits>::Writer::write(void const*, unsigned int, std::chrono::duration<long long, std::ratio<1ll, 1000ll> >)':
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x150): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x1a0): undefined reference to `__atomic_store_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x1cc): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x20c): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x2ac): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x2c4): undefined reference to `__atomic_store_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x3a8): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x410): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x424): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x450): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x464): undefined reference to `__atomic_load_8'
CMakeFiles/SampleApp.dir/PortAudioMicrophoneWrapper.cpp.o:PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x494): more undefined references to `__atomic_load_8' follow
CMakeFiles/SampleApp.dir/PortAudioMicrophoneWrapper.cpp.o: In function `alexaClientSDK::avsCommon::utils::sds::SharedDataStream<alexaClientSDK::avsCommon::utils::sds::InProcessSDSTraits>::Writer::write(void const*, unsigned int, std::chrono::duration<long long, std::ratio<1ll, 1000ll> >)':
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x59c): undefined reference to `__atomic_store_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x5dc): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x690): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x6a4): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x834): undefined reference to `__atomic_load_8'
PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x848): undefined reference to `__atomic_load_8'
CMakeFiles/SampleApp.dir/PortAudioMicrophoneWrapper.cpp.o:PortAudioMicrophoneWrapper.cpp:(.text._ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE[_ZN14alexaClientSDK9avsCommon5utils3sds16SharedDataStreamINS2_18InProcessSDSTraitsEE6Writer5writeEPKvjNSt6chrono8durationIxSt5ratioILx1ELx1000EEEE]+0x870): more undefined references to `__atomic_load_8' follow
../../AVSCommon/libAVSCommon.so: undefined reference to `__atomic_fetch_add_8'
collect2: error: ld returned 1 exit status
SampleApp/src/CMakeFiles/SampleApp.dir/build.make:357: recipe for target 'SampleApp/src/SampleApp' failed
make[4]: *** [SampleApp/src/SampleApp] Error 1
CMakeFiles/Makefile2:3513: recipe for target 'SampleApp/src/CMakeFiles/SampleApp.dir/all' failed
make[3]: *** [SampleApp/src/CMakeFiles/SampleApp.dir/all] Error 2
Makefile:127: recipe for target 'all' failed
make[2]: *** [all] Error 2
package/pkg-generic.mk:216: recipe for target '/home/zhaomm/project/code/buildroot-avs-sdk/buildroot-2017.02/output/build/avs-sdk/.stamp_built' failed
make[1]: *** [/home/zhaomm/project/code/buildroot-avs-sdk/buildroot-2017.02/output/build/avs-sdk/.stamp_built] Error 2
Makefile:79: recipe for target '_all' failed


- 解决方案 

github中AVS-SDK有类似的问题 https://github.com/alexa/avs-device-sdk/issues/380 

最终在 avs-sdk/SampleApp/src/CMakeLists.txt  添加 set(CMAKE_CXX_LINK_FLAGS "${CMAKE_CXX_LINK_FLAGS} -latomic")



### buildroot 裁剪

- make show-targets 查看依赖

toolchain-external toolchain-external-custom toolchain alsa-lib avahi avs-sdk bluez_utils boost busybox bzip2 check cjson connman dbus e2fsprogs host-e2fsprogs expat ffmpeg gdb host-genext2fs glib-networking gmp gnutls gst1-plugins-bad gst1-rtsp-server gst1-plugins-good gst1-plugins-base gst1-libav gstreamer1 gst1-plugins-ugly hostapd initscripts inotify-tools iptables iw kmod lame libarchive libcurl libdaemon libdvdcss libdvdread libevdev libevent libffi libgcrypt libglib2 libgmime libgpg-error libid3tag libidn libmad libmnl libmpeg2 libnetfilter_conntrack libnfnetlink libnl libogg libsamplerate libsndfile libsoup libsoxr libtasn1 libtool libtotem libunistring libusb libxml2 libxslt lzo mbedtls host-mke2img mpg123 mtd ncurses nettle nghttp2 ntp openssh openssl pcre pkgconf portaudio readline skeleton sqlite taglib util-linux wpa_supplicant zlib host-mke2img host-fakeroot host-makedevs host-mkpasswd host-mtd host-fakeroot host-makedevs host-mkpasswd rootfs-ext2 rootfs-ubifs

- 第一次编译出来的大小

-rw-r--r-- 1 zhaomm zhaomm 118M 8月   8 14:02 rootfs.ext2
lrwxrwxrwx 1 zhaomm zhaomm   11 8月   8 14:02 rootfs.ext4 -> rootfs.ext2
-rw-r--r-- 1 zhaomm zhaomm  59M 8月   8 14:02 rootfs.ubifs


- 裁剪部分　
- expect 
- ffmpeg 
- gdb 
- hostapd 
- inotify-tools
- iptables
- iw 
- openssh 
- wpa_supplicant 
- 